# Den andrederiverte

Hva skjer når vi derivere en funksjon $f:\mathbb{R}^2\rightarrow\mathbb{R}$ to ganger?

Siden $\frac{\partial f}{\partial \vec{n}} (x, y)$ er en funksjon $\mathbb{R }^2\rightarrow\mathbb{R }$, kan vi derivere den med hensyn på en annen retning $\vec{m}$. Vi får da den andrederiverte $\frac{\partial^2f}{\partial \vec{n} \partial \vec{m}}$. Akkurat som før er det nok å kun beregne de partiellderiverte

$$
H = 
\left(\begin{array}{cc}
     \frac{\partial^2 f}{\partial x^2} & \frac{\partial^2 f}{\partial x
     \partial y}\\
     \frac{\partial^2 f}{\partial y \partial x} & \frac{\partial^2 f}{\partial
     y^2}
   \end{array}\right)
$$

Vi har ikke samlet de i en matrise $H$ (som heter *Hessematrisen*) uten grunn! Generelt er den andrederiverte lik

$$
\frac{\partial^2 f}{\partial \vec{n} \partial \vec{m}} =
   \left(\begin{array}{cc}
     n_x & n_y
   \end{array}\right) \left(\begin{array}{cc}
     \frac{\partial^2 f}{\partial x^2} & \frac{\partial^2 f}{\partial x
     \partial y}\\
     \frac{\partial^2 f}{\partial y \partial x} & \frac{\partial^2 f}{\partial
     y^2}
   \end{array}\right) \left(\begin{array}{c}
     m_x\\
     m_y
   \end{array}\right) 
$$

Det viser seg at (*stort sett, se eksempel 2 under*) $\frac{\partial^2f}{\partial y \partial x}$=$\frac{\partial^2 f}{\partial x \partial y}$. Det betyr at Hessematrisen er symmetrisk, og at rekkefølgen av retningene ikke har noe å si, altså

$$
\frac{\partial^2 f}{\partial \vec{n} \partial \vec{m}} = \frac{\partial^2
   f}{\partial \vec{m} \partial \vec{n}}
$$


### Eksempel 1

La $f(x,y) = \exp(-x)\sin{y} + 2x + y^2$.

Da er
$$
\frac{\partial f}{\partial x} = -\exp(-x)\sin{y} + 2, \quad
\frac{\partial f}{\partial y} = \exp(-x)\cos{y} + 2y
$$

Slik at
$$
\frac{\partial^2 f}{\partial x^2} = \frac{\partial}{\partial x} \frac{\partial f}{\partial x}
= \frac{\partial}{\partial x} \big( -\exp(-x)\sin{y} + 2 \big) = \exp(-x)\sin{y}
$$
$$
\frac{\partial^2 f}{\partial y \partial x} = \frac{\partial}{\partial y} \frac{\partial f}{\partial x}
= \frac{\partial}{\partial y} \big( -\exp(-x)\sin{y} + 2 \big) = -\exp(-x)\cos{y}
$$
$$
\frac{\partial^2 f}{\partial x\partial y} = \frac{\partial}{\partial x} \frac{\partial f}{\partial y}
= \frac{\partial}{\partial x} \big( \exp(-x)\cos{y} + 2y \big) = -\exp(-x)\cos{y}
$$
$$
\frac{\partial^2 f}{\partial y^2} = \frac{\partial}{\partial y} \frac{\partial f}{\partial y}
= \frac{\partial}{\partial y} \big( \exp(-x)\cos{y} + 2y \big) = -\exp(-x)\sin{y} + 2
$$

Linjene 2 og 3 over er som forventet helt like, så vi trengte egentlig bare å beregne ut en av dem. Vi får altså Hessematrisen

$$
H(x,y) =
\begin{pmatrix}
\exp(-x)\sin{y} & -\exp(-x)\cos{y} \\
-\exp(-x)\cos{y} & -\exp(-x)\sin{y} + 2
\end{pmatrix}
$$

Vi ønsker å finne den andrederiverte $\frac{\partial^2 f}{\partial \vec{m}\partial \vec{n}}$ i origo ($x=0,y=0$) og i retningene $\vec{m} = \frac{1}{\sqrt{2}}(1,-1)$ og $\vec{n} = \frac{1}{\sqrt{2}}(1,1)$. Vi beregner først

$$
H(0,0) = 
\begin{pmatrix}
\exp(-0)\sin{0} & -\exp(-0)\cos{0} \\
-\exp(-0)\cos{0} & -\exp(-0)\sin{0} + 2
\end{pmatrix}
=
\begin{pmatrix}
0 & -1 \\
-1 & 2
\end{pmatrix}
$$

Derfor er 
$$
\frac{\partial^2 f}{\partial \vec{m}\partial \vec{n}} =
\frac{1}{\sqrt{2}}(1,-1)
\begin{pmatrix}
0 & -1 \\
-1 & 2
\end{pmatrix}
\frac{1}{\sqrt{2}}
\begin{pmatrix}
1 \\
1
\end{pmatrix}
= \frac{1}{2}(
1\cdot 0 \cdot 1 + 1\cdot -1\cdot 1 + -1\cdot -1\cdot 1 + -1\cdot 2\cdot 1)
= -1
$$

### Med flere variabler

Det fungerer på samme måte for funksjoner med flere enn to variable. For eksempel, for funksjoner med tre variabler får vi Hessematrisen

$$
H = 
\left(\begin{array}{ccc}
     \frac{\partial^2 f}{\partial x^2} & \frac{\partial^2 f}{\partial x
     \partial y} & \frac{\partial^2 f}{\partial x\partial z}\\
     \frac{\partial^2 f}{\partial y \partial x} & \frac{\partial^2 f}{\partial
     y^2} & \frac{\partial^2 f}{\partial y\partial z} \\
      \frac{\partial^2 f}{\partial z \partial x} & \frac{\partial^2 f}{\partial z \partial y} & \frac{\partial^2 f}{\partial z^2}
   \end{array}\right)
$$

Matrisen er symmetrisk, og vi har $\frac{\partial^2 f}{\partial x_i \partial x_j}=\frac{\partial^2 f}{\partial x_j \partial x_i}$ for alle $i,j$.

### Eksempel 2

La oss se på $f(x,y,z)=x^2 yz$.

Da er

$$
\frac{\partial f}{\partial x} = 2xyz, \quad
\frac{\partial f}{\partial y} = x^2 z, \quad
\frac{\partial f}{\partial z} = x^2 y
$$

Da har vi

$$
\frac{\partial^2 f}{\partial x^2} = \frac{\partial}{\partial x} 2xyz = 2yz, \quad
\frac{\partial^2 f}{\partial x\partial y} = \frac{\partial}{\partial x} x^2 z = 2xz, \quad
\frac{\partial^2 f}{\partial x\partial z} = \frac{\partial}{\partial x} x^2 y = 2xy
$$

Neste er

$$
\frac{\partial^2 f}{\partial y\partial x} = \frac{\partial}{\partial y} 2xyz = 2xz, \quad
\frac{\partial^2 f}{\partial y^2} = \frac{\partial}{\partial y} x^2 z = 0, \quad
\frac{\partial^2 f}{\partial y\partial z} = \frac{\partial}{\partial y} x^2 y = x^2
$$

Og siste

$$
\frac{\partial^2 f}{\partial z\partial x} = \frac{\partial}{\partial z} 2xyz = 2xy, \quad
\frac{\partial^2 f}{\partial z\partial y} = \frac{\partial}{\partial z} x^2 z = x^2, \quad
\frac{\partial^2 f}{\partial z\partial z} = \frac{\partial}{\partial z} x^2 y = 0
$$

Den andrederiverte (Hessematrisen) er da

$$
H = 
\begin{pmatrix}
2yz & 2xz & 2xy \\
2xz & 0 & x^2 \\
2xy & x^2 & 0
\end{pmatrix}
$$

### Noen kommentarer utenfor pensum.

Det er mulig å finne på eksempler hvor $\frac{\partial^2 f}{\partial y \partial x}\neq\frac{\partial^2 f}{\partial x \partial y}$. Det kan skje hvis de partielle deriverte ikke er kontinuerlige i nærheten av et punkt. Dette er egentlig ikke eksamenspensum, men eksemplene under kan bidra til økt forståelse.

### Eksempel 3

Kanskje det letteste eksemplet på en slik funksjon er
$$
f(x,y) = 
\begin{cases}
 0 & y \neq 0 \\
 1 & y=0
\end{cases}
$$

Siden $f(x,y)$ er uavhengig av $x$ er $\frac{\partial f}{\partial x} = 0$. Dermed er $\frac{\partial^2 f}{\partial y \partial x} = 0$. Men $\frac{\partial f}{\partial y}$ er ikke definert i origo, så $\frac{\partial^2 f}{\partial y \partial x}$ finnes ikke.

### Eksempel 4

En muligens mer opplysende (men litt vanskeligere) eksempel er

$$
f(x,y) =
\begin{cases}
 0 & (x,y) = (0,0) \\
\frac{xy(x^2-y^2)}{x^2 + y^2} & (x,y)\neq(0,0)
\end{cases}
$$

Om vi ser bort fra origo, har vi at de partiellderiverte er
$$
\frac{\partial f}{\partial x} = \frac{x^4 y + 4y^2 x^3 - y^5}{(x^2 + y^2)^2}
$$
$$
\frac{\partial f}{\partial y} = \frac{x^5 - 4x^3 y^2 - xy^4}{(x^2 + y^2)^2}.
$$

For å forstå hva som skjer i origo trenger vi et par grenseverdier. Det viser seg nemlig at

$$
\frac{\partial f}{\partial x}(0,y) = -y, \quad
\frac{\partial f}{\partial y}(x,0) = x
$$

Dermed har vi
$$
\frac{\partial^2 f}{\partial x\partial y}(0,0) = -1, \quad
\frac{\partial^2 f}{\partial y\partial x}(0,0) = 1
$$
som ikke er like hverandre.