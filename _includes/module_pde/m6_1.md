# Partielle differentialligninger

## 1. Innføring

*Alle lykkelige familier ligner hverandre, hver ulykkelige familie er ulykkelige på sin egen måte*  (sitat: Leo Tolstoj).

Den tidligere NTNU-affilierte læreren Ariah Iserles likte å sitere Tolstoj i forbindelse med differensialligninger. Alle ordinære differensialligninger er faktiske like; det finnes alltid et lokalt koordinatbytte som sender en vilkårlig ligning til en annen (lokal på grunn av mulige "eksplosjoner", hvor løsningen går mot uendelig). 

Det er ikke en nyttig observasjon når det gjelder løsning av ligninger, siden det er vanskeligere å finne et slikt koordinatbytte enn det er å løse ligningen. Men det forklarer hvorfor det finnes flere "En størrelse passer alle"-metoder, slik som Eulers metode, for å løse dem, *og lignende teoremer som forsikrer oss at det finnes en entydig løsning som gir mening*. 

Slik er det ikke med partielle differensialligninger.

Teori og praksis på partielle differensialligninger er drevet frem av forskjellige eksempler og det vi vet om dem. *Det finnes riktignok en del teorier som gjelder generelt, og spesielt på lineære ligninger, men de er ofte veldig krevende og av mindre interesse for oss.*

Vi kommer altså til å se at numeriske metoder må være tilpasset den spesifikke ligningen som løses, i motsetning til Eulers metode som fungerer på alle ordinære differensialligninger.

### Eksempel 1

Det enkleste eksemplet vi kan tenke på er kanskje

$$
\frac{\partial f}{\partial x} = 0.
$$

Ligningen sier at $f$ ikke forandrer seg i retningen $x$, dvs. $f (x_1, y)$ og $f (x_2, y)$ er de samme for alle verdier $x_1$ og $x_2$. Alle funksjoner av formen $f(x, y) = f(y)$ oppfyller det kravet og er dermed løsninger. Et av mange eksempler er $f(x,y)=y^2$.

Det ser kanskje forvirrende ut med utrykk som $f(x, y) = f(y)$. Hva har skjedd med $x$? Husk at $f$ her er en funksjon fra $\mathbb{R}^2\rightarrow\mathbb{R }$. Med $f (y)$ mener vi en funskjon hvor verdiene er uavhengig av $x$. Siden alle slike funksjoner oppfyller ligningen, må vi ha vesentlig mer informasjon, f. eks. randbetingelser, hvis vi ønsker oss en entydig løsning.

Under ser vi plottet av funksjonen
$$
f(x,y) = \sin(y),
$$
som er én (av mange) løsninger av ligningen.


```{pyodide-python}
import numpy as np
import matplotlib.pyplot as plt

plt.close("all")

# data
x = np.linspace(-1, 1, 256)
y = np.linspace(-1, 1, 256)
X, Y = np.meshgrid(x, y)
Z = np.sin(np.pi * Y)

# ONE figure, ONE axes, controlled size
fig, ax = plt.subplots(
    subplot_kw={"projection": "3d"},
    figsize=(6, 4)
)

ax.plot_surface(X, Y, Z)
ax.set_xlabel("x")
ax.set_ylabel("y")
ax.set_zlabel("z")

plt.show()

```

### Eksempel 2

Det enkleste eksemplet med partiellderiverte i begge variable er kanskje

$$
\frac{\partial f}{\partial x} = \frac{\partial f}{\partial y}. 
$$

Denne ligningen er et eksempel på en klasse med partielle differensiallikninger som kalles **transportligninger**. Vi sjekker ved innsetting at $f (x, y) = x^2 + 2 x y + y^2$ løser denne ligningen, siden både

$$
\frac{\partial f}{\partial x} = 2x + 2y
$$

og

$$
\frac{\partial f}{\partial y} = 2x + 2y.
$$

Vi legger merke til at vi kan skrive om ligningen som

$$
\frac{\partial f}{\partial x} - \frac{\partial f}{\partial y} = 0
$$

eller med andre ord

$$
\frac{\partial f}{\partial \vec{n}} = 0, \quad 
\vec{n} = \frac{1}{\sqrt{2}} \begin{pmatrix}
1 \\
-1
\end{pmatrix}.
$$

Så ligningen er ikke så annerledes enn Eksempel 1. Den sier at en bestemt retningsderivert alltid er null. Vi kunne egentlig byttet koordinater til et system $p = x-y, q = x+y$, og da ville ligningen vært nøyaktig som i Eksempel 1. Altså den deriverte mhp. $p$ ville vært null, og funksjonen ville vært en funksjon av $q$ alene. Det viser seg at alle funksjoner på formen

$$
f(x,y) = g(x+y)
$$

løser ligningen. I koden under viser vi et eksempel på dette.


```{pyodide-python}
import numpy as np
import matplotlib.pyplot as plt

plt.close("all")

# data
x = np.linspace(-1, 1, 256)
y = np.linspace(-1, 1, 256)
X, Y = np.meshgrid(x, y)

# function
Z = np.sin(np.pi * (X + Y))

# ONE figure, ONE 3D axes
fig, ax = plt.subplots(
    subplot_kw={"projection": "3d"},
    figsize=(6, 4)
)

ax.plot_surface(X, Y, Z)
ax.set_xlabel("x")
ax.set_ylabel("y")
ax.set_zlabel("f")

ax.quiver([0,0,0],[0,0,0],[-1,-1,-1],[1,1,0],[-1,1,0],[0,0,2], color='black')
ax.text(1,-1,-1,"p")
ax.text(1,1,-1,"q")
ax.text(0,0,1,"g")

plt.show()

```

### Transport

Hvorfor kaller vi ligningen i Eksempel 2 for en <em>transport-</em>ligning?

La oss nå anta en av variablene måler tid, vi omdøper $y$ til $t$, og skriver ligningen som

$$
\frac{\partial u}{\partial t} = c\frac{\partial u}{\partial x}, \quad u(x,0) = g(x)
$$

Løsningen med hensyn på tiden $t$ er altså $u(x,t) = g(x+ct)$

Tolkningen er da at initialsignalet (initial, fordi den er gitt for $t = 0$) $g(x)$ flytter seg langs $x$-aksen med konstant fart $c$. 

### Oppgave 

Prøv å forstå hvorfor, med bakgrunn i det du kan om grafer av funksjoner av en variabel.

### Animasjon

I stedet for å plotte funksjoner $u(x,t)$ av to variabler (hvor én er tid) som en overflateplott, er det ofte nyttigere å lage en animasjon av $u(x,t)$ som en graf av en variabel $x$, for forskjellige tider $t$. Vi gjør det i koden under:


```{pyodide-python}
import numpy as np
import matplotlib.pyplot as plt
import matplotlib.animation as animation
from IPython.display import HTML

plt.close("all")

# vi lager verdiene av x og t som vi skal bruke
x = np.arange(0, 2*np.pi, 0.01)
t = np.arange(0, 5, 0.05)

# vi lager rutenettet
X, T = np.meshgrid(x, t)

# vi regner ut funksjonen på rutenettet
u = np.sin(X + T)

# vi lager én figur (ingen ekstra vinduer)
fig, ax = plt.subplots(figsize=(6, 4))

# vi setter faste aksegrenser slik at grafen ikke skalerer seg selv
ax.set_xlim(0, 2*np.pi)
ax.set_ylim(-1.1, 1.1)

# initialplott, for tid t = 0
line, = ax.plot(x, u[0, :], color="blue")
text = ax.text(1.7*np.pi, 0.95, 't = 0')
# funksjon som oppdaterer grafen for hvert tidssteg
def animate(i):
    line.set_ydata(u[i, :])
    tidspunkt = t[i]
    text.set_text(f't = {tidspunkt:1.2f}')
    return line,

# vi lager animasjonen
# interval bestemmer hvor fort det vises
# frames angir hvor mange tider t_i som inngår
ani = animation.FuncAnimation(
    fig,
    animate,
    frames=t.size,
    interval=20,
    blit=False    # Med blit-ing fungerer text elementene ikke
)

# vi viser animasjonen i Quarto / nettleser
HTML(ani.to_jshtml())
plt.show()
```

## 2. Lineære og ikke-lineære ligninger

**Merk at i PDE-litteratur er det vanlig å skrive $f_x$ for den partiellderiverte $\frac{\partial f}{\partial x}$. De andrederiverte blir $f_{yx} = \frac{\partial^2 f}{\partial x\partial y}$ osv. Det kan virker forvirrende, men det sparer masse plass.**

En generell partiell differentialligning tar formen

$$
f(u,u_x,u_y,u_{xx},u_{xy},u_{yy},\ldots) = 0
$$

Den er **lineær** hvis den tar formen
$$
f(x,y)u + g(x,y)u_x + h(x,y)u_y + \ldots = 0
$$

Ligningen
$$
f(x,y)u + g(x,y)u_x + h(x,y)u_y = 0
$$

kalles for **førsteordens**, siden det kun er vanlige (førsteordens) partiellderiverte $u_x$ og  $u_y$ som er med.

En ligning
$$
f(x,y)u + g(x,y)u_x + h(x,y)u_{yy} = 0
$$

derimot er **andreordens**, siden vi har en andrederivert $u_{yy}$ med.

### Hvorfor bryr vi oss om linearitet?

[ikke pensum]

Generelt så er det lettere å løse lineære ligninger. De fleste ligningene vi skal se på i dette kurset er enten lineære, eller blant de lettere ikke-lineære ligningene.

### Eksempler

Noen ligninger:

#### a) Transportligningen

$$
u_t + c(x,t)u_x = f(x,t)
$$

er lineær og førsteordens. Funksjonene $a(x,t)$ og $f(x,t)$ er ikke et problem for linearitet, da de ikke er avhengige av $u$.

#### b) Schrødingers ligning

$$
i\hbar u_t = -\frac{\hbar^2}{2m}  u_{xx} + V(x) u = 0
$$
er lineær og andreordens. (Symbolet $\hbar$ er en reell konstant og $i$ er den imaginære enheten. Lingingen er altså kompleks-verdig.)

#### c) Klein-Gordons ligning

$$
u_{tt} - u_{xx} + u = 0
$$

er lineær og andreordens.

#### d) Sine-Gordons ligning

$$
u_{tt} - u_{xx} + \sin u = 0
$$

er andreordens, men ikke-lineær, siden $\sin u$ er en ikke-lineær funksjon av $u$.

#### e) Biharmonisk ligning

$$
u_{xxxx} + u_{xxyy} + u_{yyyy} = 0
$$

er lineær og fjerdeordens.

#### f)  Korteweg–De Vries (KdV) ligning

$$
u_t + uu_x + u_{xxx} = 0
$$

er ikke-lineær pga. leddet $uu_x$ og andreordens. (En $u$ ganget med en deriverte av $u$)

#### g) Eikonalligningen

$$
||\nabla u|| = 1
$$

som kan skrives som 
$$
u_x^2 + u_y^2 = 1,
$$

er førsteordens og ikke-lineær, siden $u_x$ og $u_y$ begge opphøyes i andre potens.


